const VALID_SORTS=["vehicles","spoilers","rims","body-colors","textures","tire-stickers","tire-styles","drifts","hyperchromes","furnitures","limited-items"];function formatTimeAgo(e){if(!e)return null;const t=Math.floor(Date.now()/1e3)-e,o={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};if(t<60)return"just now";for(const[e,n]of Object.entries(o)){const o=Math.floor(t/n);if(o>=1)return`${o} ${e}${1===o?"":"s"} ago`}}function debounce(e,t){let o;return function(...n){clearTimeout(o),o=setTimeout((()=>e.apply(this,n)),t)}}function showLoadingOverlay(){$("#loading-overlay").addClass("show")}function hideLoadingOverlay(){$("#loading-overlay").removeClass("show")}window.shareCurrentView=debounce((function(){const e=document.getElementById("sort-dropdown"),t=document.getElementById("value-sort-dropdown"),o=document.getElementById("search-bar"),n=new URLSearchParams;"name-all-items"!==e.value&&n.append("sort",e.value.split("-").slice(1).join("-")),"random"!==t.value&&n.append("valueSort",t.value),o.value.trim()&&n.append("search",o.value.trim());const s=`${window.location.origin}/values`,a=n.toString()?`${s}?${n.toString()}`:s;navigator.clipboard.writeText(a).then((()=>{notyf.success("Link copied to clipboard!","Share",{timeOut:2e3,closeButton:!0,positionClass:"toast-bottom-right"})})).catch((()=>{notyf.error("Failed to copy link","Share Error",{timeOut:2e3,closeButton:!0,positionClass:"toast-bottom-right"})}))}),1e3);const searchBar=document.getElementById("search-bar"),clearButton=document.getElementById("clear-search");function clearSearch(){const e=document.getElementById("search-bar"),t=document.getElementById("clear-search");e&&(e.value="",filterItems()),t&&(t.style.display="none")}function updateTotalItemsLabel(e){const t=document.getElementById("total-items-label");if(t)if("favorites"===e)t.textContent="Total Favorites: ";else if("all-items"===e)t.textContent="Total Items: ";else{let o;o="hyperchromes"===e?"HyperChrome":e.slice(0,-1).split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),t.textContent=`Total ${o}s: `}}function updateSearchPlaceholder(){const e=document.getElementById("sort-dropdown").value,t=document.getElementById("search-bar"),o=e.split("-").slice(1).join("-");t.placeholder={"all-items":"Search items...","limited-items":"Search limited items...",vehicles:"Search vehicles (e.g., Brulee, Torpedo)...",spoilers:"Search spoilers (e.g., Rocket, Wing)...",rims:"Search rims (e.g., Star, Spinner)...","tire-stickers":"Search tire stickers (e.g., Badonuts, Blue 50)...","tire-styles":"Search tire styles (e.g., Brickset, Glacier)...",drifts:"Search drifts... (e.g., Cartoon, Melons)...","body-colors":"Search colors (e.g., Red, Blue)...",textures:"Search textures (e.g., Aurora, Checkers)...",hyperchromes:"Search HyperChromes (e.g., HyperBlue Level 2)...",furniture:"Search furniture (e.g., Nukamo Fridge, Bloxy Lisa)..."}[o]||"Search items..."}function toggleContributors(e){const t=e.nextElementSibling,o=e.querySelector(".toggle-icon");window.innerWidth<=768&&(t.classList.toggle("expanded"),o.classList.toggle("collapsed"),localStorage.setItem("contributorsExpanded",t.classList.contains("expanded")))}function preloadDriftThumbnails(e){e&&0!==e.length&&e.forEach((e=>{(new Image).src=`/assets/images/items/480p/drifts/${e.name}.webp`}))}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".category-item").forEach((e=>{e.addEventListener("click",(function(){const e={"category-limited-items":"name-limited-items","category-vehicles":"name-vehicles","category-rims":"name-rims","category-spoilers":"name-spoilers","category-body-colors":"name-body-colors","category-textures":"name-textures","category-hyperchromes":"name-hyperchromes","category-tire-stickers":"name-tire-stickers","category-tire-styles":"name-tire-styles","category-drifts":"name-drifts","category-furnitures":"name-furnitures","category-favorites":"name-all-items"},t=Array.from(this.classList).find((t=>Object.keys(e).includes(t)));if(!t)return void console.error("No specific category class found");const o=e[t],n=document.getElementById("sort-dropdown"),s=document.getElementById("value-sort-dropdown");if(n&&s){n.value=o,s.value="category-favorites"===t?"favorites":"cash-desc",window.sortItems();const e=document.getElementById("items-container");e&&setTimeout((()=>{const t=document.querySelector(".filter-controls"),o=e.getBoundingClientRect().top+window.pageYOffset-(t.offsetHeight+90);window.scrollTo({top:o,behavior:"smooth"})}),100)}else console.error("Dropdowns not found")}))})),window.filterItems=debounce((function(){const e=document.getElementById("search-bar").value.toLowerCase(),n=document.getElementById("search-bar"),a=document.getElementById("sort-dropdown").value,r=document.querySelector("#items-container"),i=document.getElementById("search-messages");e?localStorage.setItem("searchTerm",e):localStorage.removeItem("searchTerm"),i&&(i.innerHTML="");let l=[...t];if("name-all-items"!==a){const e=a.split("-").slice(1).join("-");l=t.filter((t=>{if("limited-items"===e)return t.is_limited;return t.type.toLowerCase().replace(" ","-")===e.slice(0,-1)}))}if(0===e.length){s=l,n.classList.remove("is-invalid");const e=document.getElementById("value-sort-dropdown"),t=e?.value||"cash-desc";"random"===t?s=v([...s]):"cash-desc"===t?s.sort(((e,t)=>{const o=h(e.cash_value).numeric;return h(t.cash_value).numeric-o})):"alpha-desc"===t&&s.sort(((e,t)=>t.name.localeCompare(e.name)));let i=r.querySelector(".row");i||(i=document.createElement("div"),i.classList.add("row"),r.appendChild(i));return updateTotalItemsLabel(a.split("-").slice(1).join("-")),o=1,p(),void u()}if(e.length<1)return void(i&&(i.innerHTML='\n                <div class="search-feedback">\n                    Please enter at least 1 character to search\n                </div>\n            '));n.classList.remove("is-invalid"),s=l.filter((t=>t.name.toLowerCase().includes(e)));if(updateTotalItemsLabel(a.split("-").slice(1).join("-")),u(),0!==s.length)o=1,p();else{let t=r.querySelector(".row");t||(t=document.createElement("div"),t.classList.add("row"),r.appendChild(t));const o=document.getElementById("sort-dropdown").value,n=o.split("-").slice(1).join(" "),s="name-all-items"!==o?` under category "${n.replace(/-/g," ")}"`:"";t.innerHTML=`\n            <div class="col-12 d-flex justify-content-center align-items-center" style="min-height: 300px;">\n                <div class="no-results">\n                    <h4>No items found for "${e}"${s}</h4>\n                    <p class="text-muted">Try different keywords or check the spelling</p>\n                </div>\n            </div>\n        `}}),300);const e=document.querySelector("#items-container");if(!e)return;let t=[],o=1;const n=24;let s=[],a=!1,r="";window.sortItems=function(){if(a)return;if(!t||0===t.length)return;const n=document.getElementById("sort-dropdown"),i=document.getElementById("value-sort-dropdown"),l=n?.value||"name-all-items",d=i?.value||"cash-desc",c=l.split("-").slice(1).join("-");sessionStorage.setItem("sortDropdown",l),sessionStorage.setItem("valueSortDropdown",d),r=l;const m=l.split("-"),g=m[0],f=m.slice(1).join("-");if("all-items"===f?(s=[...t],localStorage.removeItem("lastSort")):"limited-items"===f?s=t.filter((e=>e.is_limited)):"name"===g&&"hyperchromes"===f?s=t.filter((e=>"HyperChrome"===e.type)):(s=t.filter((e=>e.type.toLowerCase().replace(" ","-")===f.slice(0,-1))),localStorage.setItem("lastSort",l)),"random"===d)s=v([...s]);else{if("favorites"===d){if(!Cookies.get("token")){s=[];let t=e.querySelector(".row");return t||(t=document.createElement("div"),t.classList.add("row"),e.appendChild(t)),t.innerHTML='\n          <div class="col-12">\n            <div class="no-favorites-message">\n             <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24">\n\t<rect width="24" height="24" fill="none" />\n\t<path fill="#f8ff00" d="m8.85 16.825l3.15-1.9l3.15 1.925l-.825-3.6l2.775-2.4l-3.65-.325l-1.45-3.4l-1.45 3.375l-3.65.325l2.775 2.425zM5.825 21l1.625-7.025L2 9.25l7.2-.625L12 2l2.8 6.625l7.2.625l-5.45 4.725L18.175 21L12 17.275zM12 12.25" />\n</svg>\n              <h4>Login Required</h4>\n              <p>You need to be logged in to view your favorite items</p>\n              <div class="login-prompt">\n                <a href="/login" class="login-link">Login now</a>\n              </div>\n            </div>\n          </div>\n        ',u(),void updateTotalItemsLabel("favorites")}let n=t.filter((e=>e.is_favorite));if("all-items"!==f)if("limited-items"===f)n=n.filter((e=>e.is_limited));else if("hyperchromes"===f)n=n.filter((e=>"HyperChrome"===e.type));else{const e=f.slice(0,-1);n=n.filter((t=>t.type.toLowerCase().replace(" ","-")===e))}if(s=n,0===s.length){let t=e.querySelector(".row");t||(t=document.createElement("div"),t.classList.add("row"),e.appendChild(t));const o="all-items"===f?"":` in ${f.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}`;return void(t.innerHTML=`\n          <div class="col-12">\n            <div class="no-favorites-message">\n             <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24">\n\t<rect width="24" height="24" fill="none" />\n\t<path fill="#f8ff00" d="m8.85 16.825l3.15-1.9l3.15 1.925l-.825-3.6l2.775-2.4l-3.65-.325l-1.45-3.4l-1.45 3.375l-3.65.325l2.775 2.425zM5.825 21l1.625-7.025L2 9.25l7.2-.625L12 2l2.8 6.625l7.2.625l-5.45 4.725L18.175 21L12 17.275zM12 12.25" />\n</svg>  \n              <h4>No Favorites Yet${o}</h4>\n              <p>You haven't added any ${o?`favorite items${o}`:"items to your favorites"}</p>\n            </div>\n          </div>\n        `)}return o=1,p(),void updateTotalItemsLabel("favorites")}if("none"!==d){const[e,t]=d.split("-");s.sort(((o,n)=>{const s="cash"===e?o.cash_value:o.duped_value,a="cash"===e?n.cash_value:n.duped_value,r=!s||"N/A"===s||"'N/A'"===s,i=!a||"N/A"===a||"'N/A'"===a;if(r&&i)return o.name.localeCompare(n.name);if(r)return 1;if(i)return-1;const l=h(s).numeric,d=h(a).numeric;return"asc"===t?l-d:d-l}))}}if("alpha-asc"!==d&&"alpha-desc"!==d||s.sort(((e,t)=>"alpha-asc"===d?e.name.localeCompare(t.name):t.name.localeCompare(e.name))),"demand-asc"===d||"demand-desc"===d){const e=["Close to none","Very Low","Low","Medium","Decent","High","Very High"];s.sort(((t,o)=>{let n="N/A"===t.demand?"-":t.demand||"-",s="N/A"===o.demand?"-":o.demand||"-";if("-"===n&&"-"===s)return 0;if("-"===n)return 1;if("-"===s)return-1;const a=e.findIndex((e=>e.toLowerCase()===n.toLowerCase())),r=e.findIndex((e=>e.toLowerCase()===s.toLowerCase()));return-1===a?1:-1===r?-1:"demand-asc"===d?a-r:r-a}))}else"last-updated-desc"!==d&&"last-updated-asc"!==d||s.sort(((e,t)=>e.last_updated||t.last_updated?e.last_updated?t.last_updated?"last-updated-desc"===d?t.last_updated-e.last_updated:e.last_updated-t.last_updated:-1:1:0));updateSearchPlaceholder(),updateTotalItemsLabel(f),searchBar&&searchBar.value.trim()?filterItems():(o=1,p());const y=document.querySelector(".category-name"),w=document.getElementById("values-breadcrumb");if("name-all-items"===l)y.style.display="none",w.classList.add("active"),w.setAttribute("aria-current","page"),w.innerHTML="Values";else{let e;e="hyperchromes"===c?"Hyperchromes":c.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),y.innerHTML=`<a href="/values?sort=name-${c}" onclick="handleCategoryClick(event, '${c}')">${e}</a>`,y.style.display="list-item",y.classList.add("active"),y.setAttribute("aria-current","page"),w.classList.remove("active"),w.removeAttribute("aria-current"),w.innerHTML='<a href="/values">Values</a>'}};const i=sessionStorage.getItem("sortDropdown"),l=sessionStorage.getItem("valueSortDropdown")||"cash-desc";if(i||l){const e=document.getElementById("sort-dropdown"),t=document.getElementById("value-sort-dropdown");if(e&&t)try{i&&(e.value=i),l&&(t.value=l),r=i,"function"==typeof window.sortItems?window.sortItems():console.error("sortItems function not properly initialized")}catch(e){console.error("Error restoring sort:",e)}}document.getElementById("sort-dropdown").addEventListener("change",(()=>{window.sortItems()})),document.getElementById("value-sort-dropdown").addEventListener("change",(()=>{window.sortItems()}));const d=document.createElement("div");d.className="loading-spinner",d.innerHTML='\n     <div class="spinner-border" role="status">\n       <span class="visually-hidden">Loading...</span>\n     </div>\n   ',e.appendChild(d);const c=new IntersectionObserver((e=>{e[0].isIntersecting&&!a&&async function(){if(a)return;const e=o*n,t=e+n;if(e>=s.length)return;a=!0;const r=document.querySelector(".loading-spinner");r&&r.classList.add("active");await new Promise((e=>setTimeout(e,800))),o++;const i=document.querySelector("#items-container .row"),l=s.slice(e,t),d=document.createDocumentFragment();l.forEach((e=>{const t=g(e);d.appendChild(t)})),i.appendChild(d),r&&r.classList.remove("active");a=!1}()}),{rootMargin:"100px"}),m=document.getElementById("back-to-top");function u(){const e=document.getElementById("total-items");e&&(e.textContent=s.length)}function p(){const e=document.querySelector("#items-container");if(!e)return void console.warn("Items container not found");let t=e.querySelector(".row");const a=e.querySelector(".loading-spinner");t&&1!==o||(a&&a.remove(),e.innerHTML='\n            <div class="row g-3" id="items-list"></div>\n            <div class="loading-spinner">\n                <div class="spinner-border" role="status">\n                    <span class="visually-hidden">Loading...</span>\n                </div>\n            </div>\n        ',t=e.querySelector(".row"));const r=(o-1)*n,i=r+n,l=s.slice(r,i),d=document.createDocumentFragment();for(let e=0;e<l.length;e++){const t=g(l[e]);d.appendChild(t)}t.appendChild(d);const m=e.querySelector(".sentinel");if(m&&m.remove(),i<s.length){const e=function(){const e=document.createElement("div");return e.className="sentinel",e.style.height="1px",document.querySelector("#items-container").appendChild(e),e}();c.observe(e)}u()}function h(e){if(null==e||""===e)return{display:"No Value",numeric:0};let t,o=e;return"string"==typeof e&&(o=(e=e.toLowerCase().replace(",",".")).endsWith("m")?1e6*parseFloat(e):e.endsWith("k")?1e3*parseFloat(e):parseFloat(e)),isNaN(o)?{display:"-",numeric:0}:(t=window.innerWidth<=768?o>=1e6?(o/1e6).toFixed(2).replace(/\.?0+$/,"")+"M":o>=1e3?(o/1e3).toFixed(2).replace(/\.?0+$/,"")+"K":o.toString():o.toLocaleString("en-US"),{display:t,numeric:o})}function g(e){const o=document.createElement("div");o.classList.add("col-6","col-md-4","col-lg-3","mb-4");const n=`\n    <div class="favorite-icon position-absolute top-0 start-0 p-2" \n         style="z-index: 1000; opacity: 1; transition: opacity 0.2s ease-in-out;">\n      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"\n           style="filter: drop-shadow(0 0 2px rgba(0,0,0,0.7));">\n        <rect width="24" height="24" fill="none" />\n        <path fill="${e.is_favorite?"#f8ff00":"none"}" \n              stroke="${e.is_favorite?"none":"#f8ff00"}"\n              stroke-width="1.5"\n              d="M12.954 1.7a1 1 0 0 0-1.908-.001l-2.184 6.92l-6.861-.005a1 1 0 0 0-.566 1.826l5.498 3.762l-2.067 6.545A1 1 0 0 0 6.4 21.86l5.6-4.006l5.594 4.007a1 1 0 0 0 1.536-1.114l-2.067-6.545l5.502-3.762a1 1 0 0 0-.566-1.826l-6.866.005z" />\n      </svg>\n    </div>\n  `;"Vehicle"===e.type&&(color="#c82c2c"),"Spoiler"===e.type&&(color="#C18800"),"Rim"===e.type&&(color="#6335B1"),"Tire Sticker"===e.type&&(color="#1CA1BD"),"Tire Style"===e.type&&(color="#4CAF50"),"Drift"===e.type&&(color="#FF4500"),"Body Color"===e.type&&(color="#8A2BE2"),"Texture"===e.type&&(color="#708090"),"HyperChrome"===e.type&&(color="#E91E63"),"Furniture"===e.type&&(color="#9C6644");const s=`\n        <div class="media-container position-relative">\n            ${n}\n            ${"Drift"===e.type?`<img src="/assets/images/items/480p/drifts/${e.name}.webp" class="card-img-top thumbnail" alt="${e.name}" onerror="handleimage(this)">\n                   <video src="/assets/images/items/drifts/${e.name}.webm" class="card-img-top video-player" style="opacity: 0;" playsinline muted loop></video>`:"HyperChrome"===e.type&&"HyperShift"===e.name?'<video src="/assets/images/items/hyperchromes/HyperShift.webm" class="card-img-top" playsinline muted loop autoplay id="hypershift-video" onerror="handleimage(this)"></video>':`<img onerror="handleimage(this)" id="${e.name}" src="/assets/images/items/480p/${e.type.toLowerCase()}s/${e.name}.webp" class="card-img-top" alt="${e.name}">`}\n        </div>`,a=h(e.cash_value),r=h(e.duped_value);window.handleFavorite=async function(e,o){e.preventDefault(),e.stopPropagation();const n=Cookies.get("token");if(!n)return void notyf.error("Please login to favorite items",{position:"bottom-right",duration:2e3});const s=e.target.closest(".favorite-icon").querySelector("path"),a="#f8ff00"===s.getAttribute("fill");try{const e=await fetch("https://api3.jailbreakchangelogs.xyz/favorites/"+(a?"remove":"add"),{method:a?"DELETE":"POST",headers:{"Content-Type":"application/json",Origin:"https://jailbreakchangelogs.xyz"},body:JSON.stringify({item_id:o,owner:n})});if(!e.ok)throw new Error(`Request failed with status ${e.status}`);a?(s.setAttribute("fill","none"),s.setAttribute("stroke","#f8ff00")):(s.setAttribute("fill","#f8ff00"),s.setAttribute("stroke","none"));const r=t.find((e=>e.id===o));r&&(r.is_favorite=!a),notyf.success(a?"Item removed from favorites":"Item added to favorites",{position:"bottom-right",duration:2e3})}catch(e){console.error("Error updating favorite:",e),notyf.error("Failed to update favorite status",{position:"bottom-right",duration:2e3})}};const i=document.createElement("style");i.textContent="\n  .favorite-icon {\n    opacity: 0;\n    transition: opacity 0.2s ease-in-out;\n  }\n  \n  .items-card:hover .favorite-icon {\n    opacity: 1;\n  }\n  \n  .favorite-icon i {\n    filter: drop-shadow(0 0 2px rgba(0,0,0,0.5));\n  }\n",document.head.appendChild(i);let l="",d="";"HyperChrome"===e.type?(l='\n            <span class="hyperchrome-badge">\n              HyperChrome\n            </span>\n        ',d=""):(d=`\n            <span class="badge item-type-badge" style="background-color: ${color};">${e.type}</span>\n        `,e.is_limited&&(l='\n                <span class="badge limited-badge">\n                   <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" style="margin-right: 4px">\n\t<rect width="24" height="24" fill="none" />\n\t<path fill="#000" d="M12 20a8 8 0 0 0 8-8a8 8 0 0 0-8-8a8 8 0 0 0-8 8a8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10a10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67l-.75 1.23L11 13V7z" />\n</svg>Limited\n                </span>\n            '));const c=`\n    <div class="mt-2 d-flex align-items-center">\n        <small class="text-muted" style="font-size: 0.8rem;">\n           <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 16 16">\n\t<rect width="16" height="16" fill="none" />\n\t<g fill="#748d92">\n\t\t<path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z" />\n\t\t<path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z" />\n\t\t<path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5" />\n\t</g>\n</svg>\n            Last Updated: ${e.last_updated?formatTimeAgo(e.last_updated):"N/A"}\n        </small>\n    </div>\n    `,m=`\n        <div class="card items-card shadow-sm ${e.is_limited?"limited-item":""}" \n             onclick="handleCardClick('${e.name}', '${e.type.toLowerCase()}', event)" \n             style="cursor: pointer;">\n            <div class="position-relative">\n                ${s}\n                <div class="item-card-body text-center">\n                    <div class="badges-container d-flex justify-content-center gap-2">\n                        ${d}\n                        ${l}\n                    </div>\n                    <h5 class="card-title">${e.name}</h5>\n                    <div class="value-container">\n                        <div class="d-flex justify-content-between align-items-center mb-2 value-row">\n                            <span>Cash Value:</span>\n                            <span class="cash-value" data-value="${a.numeric}">${a.display}</span>\n                        </div>\n                        <div class="d-flex justify-content-between align-items-center mb-2 value-row">\n                            <span>Duped Value:</span>\n                            <span class="duped-value" data-value="${r.numeric}">${r.display}</span>\n                        </div>\n                        <div class="d-flex justify-content-between align-items-center value-row">\n                            <span>Demand:</span>\n                            <span class="demand-value">${"'N/A'"===e.demand||"N/A"===e.demand?"No Demand":e.demand||"No Value"}</span>\n                        </div>\n                         ${c}\n                    </div>\n                </div>\n            </div>\n        </div>`;o.innerHTML=m;const u=o.querySelector(".favorite-icon");if(u&&u.addEventListener("click",(t=>{t.stopPropagation(),window.handleFavorite(t,e.id)})),"Drift"===e.type){const e=o.querySelector(".card"),t=o.querySelector("video"),n=o.querySelector(".thumbnail");e.addEventListener("mouseenter",(()=>{t.style.opacity="1",n.style.opacity="0",t.play()})),e.addEventListener("mouseleave",(()=>{t.style.opacity="0",n.style.opacity="1",t.pause(),t.currentTime=0}))}return o.querySelector(".items-card").addEventListener("click",(t=>{t.target.closest(".favorite-icon")||handleCardClick(e.name,e.type.toLowerCase(),t)})),o}function v(e){for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}return e}window.addEventListener("scroll",(()=>{window.scrollY>300?m.style.display="flex":m.style.display="none"})),m.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})})),function(){const e=sessionStorage.getItem("sortDropdown"),t=sessionStorage.getItem("valueSortDropdown");if(e&&(document.getElementById("sort-dropdown").value=e),t){document.getElementById("value-sort-dropdown").value=t}const o=localStorage.getItem("searchTerm");if(e&&(document.getElementById("sort-dropdown").value=e),t&&(document.getElementById("value-sort-dropdown").value=t),o){const e=document.getElementById("search-bar");e.value=o;const t=document.getElementById("clear-search");t&&(t.style.display=e.value.length>0?"block":"none")}if(e&&"name-all-items"!==e){const t=e.split("-").slice(1).map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),o=document.querySelector(".category-name");o.textContent=t,o.style.display="list-item"}}(),updateSearchPlaceholder(),searchBar&&(searchBar.value="",searchBar.addEventListener("input",(function(){clearButton&&(clearButton.style.display=this.value.length>0?"block":"none")}))),window.clearFilters=debounce((function(){sessionStorage.removeItem("sortDropdown"),sessionStorage.removeItem("valueSortDropdown"),document.getElementById("sort-dropdown").value="name-all-items",document.getElementById("value-sort-dropdown").value="cash-desc",o=1,s=[...t],s.sort(((e,t)=>{const o=h(e.cash_value).numeric;return h(t.cash_value).numeric-o}));searchBar?.value?.trim()||""?filterItems():(p(),u(),updateTotalItemsLabel("all-items")),updateSearchPlaceholder(),notyf.success("Filters have been reset","Filters Reset")}),500);const f=document.getElementById("value-sort-dropdown");if(f){f.innerHTML='\n    <option value="random">Random</option>\n    <option value="favorites">My Favorites</option>\n    <option value="separator" disabled>───── Alphabetically ─────</option>\n    <option value="alpha-asc">Name (A to Z)</option>\n    <option value="alpha-desc">Name (Z to A)</option>\n    <option value="separator" disabled>───── Values ─────</option>\n    <option value="cash-asc">Cash Value (Low to High)</option>\n    <option value="cash-desc">Cash Value (High to Low)</option>\n    <option value="duped-asc">Duped Value (Low to High)</option>\n    <option value="duped-desc">Duped Value (High to Low)</option>\n    <option value="separator" disabled>───── Demand ─────</option>\n    <option value="demand-asc">Demand (Low to High)</option>\n    <option value="demand-desc">Demand (High to Low)</option>\n    <option value="separator" disabled>───── Last Updated ─────</option>\n    <option value="last-updated-asc">Last Updated (Oldest to Newest)</option>\n    <option value="last-updated-desc">Last Updated (Newest to Oldest)</option>\n  ';const e=sessionStorage.getItem("valueSortDropdown");f.value=e||"cash-desc",sortItems()}!async function(){showLoadingOverlay();try{const e=await fetch("https://api3.jailbreakchangelogs.xyz/items/list",{method:"GET",headers:{"Content-Type":"application/json",Origin:"https://jailbreakchangelogs.xyz"}});t=await e.json();const o=Cookies.get("token"),n=JSON.parse(localStorage.getItem("user")||"{}");if(o&&n.id)try{const e=await fetch(`https://api3.jailbreakchangelogs.xyz/favorites/get?user=${n.id}`,{headers:{"Content-Type":"application/json",Origin:"https://jailbreakchangelogs.xyz"}});if(e.ok){const o=(await e.json()).map((e=>e.item_id));t=t.map((e=>({...e,is_favorite:o.includes(e.id)})))}}catch(e){console.error("Error fetching favorites:",e)}s=[...t];const a=sessionStorage.getItem("sortDropdown"),r=sessionStorage.getItem("valueSortDropdown"),i=(searchBar?.value?.trim(),document.getElementById("sort-dropdown")),l=document.getElementById("value-sort-dropdown");i&&a&&(i.value=a),l&&(l.value=r||"cash-desc"),window.sortItems(),setTimeout((()=>{!function(){if(!t||0===t.length)return;const e=t.map((e=>{if("drift"===e.type.toLowerCase())return null;return`/assets/images/items/480p/${e.type.toLowerCase()}s/${e.name}.webp`})).filter((e=>null!==e)),o=10;let n=0;function s(){const t=e.slice(n,n+o);0!==t.length&&(t.forEach((e=>{(new Image).src=e})),n+=o,n<e.length&&setTimeout(s,100))}s()}();preloadDriftThumbnails(t.filter((e=>"Drift"===e.type)))}),0),u(),hideLoadingOverlay()}catch(e){console.error("Error in loadItems:",e),hideLoadingOverlay()}}();const y=new URLSearchParams(window.location.search);if(y.has("sort")){const e=y.get("sort");if(VALID_SORTS.includes(e)){const t=document.getElementById("sort-dropdown");t.value=`name-${e}`,sessionStorage.setItem("sortDropdown",t.value)}}if(y.has("valueSort")){const e=y.get("valueSort");document.getElementById("value-sort-dropdown").value=e,sessionStorage.setItem("valueSortDropdown",e)}if(window.history.replaceState({},"",window.location.pathname),sortItems(),window.innerWidth<=768){const e=document.querySelector(".contributors-grid"),t=document.querySelector(".toggle-icon");"true"===localStorage.getItem("contributorsExpanded")&&(e.classList.add("expanded"),t.classList.add("collapsed"))}})),window.handleimage=function(e){"hypershift-video"===e.id||"HyperShift"===e.alt&&e.closest(".media-container")?.querySelector("video")||(e.src="https://placehold.co/2560x1440/212A31/D3D9D4?text=No+Image+Available&font=Montserrat.webp")},window.handleCardClick=function(e,t,o){if(2===o.button)return;o.preventDefault();t.replace(/\s+/g,"-");const n=document.getElementById("sort-dropdown").value,s=document.getElementById("value-sort-dropdown").value;sessionStorage.setItem("sortDropdown",n),sessionStorage.setItem("valueSortDropdown",s);const a=encodeURIComponent(e),r=`/item/${encodeURIComponent(t.toLowerCase())}/${a}`;window.location.href=r},window.handleCategoryClick=function(e,t){e.preventDefault();const o=`name-${t.replace(/\s+/g,"-")}`;document.getElementById("sort-dropdown").value=o,sessionStorage.setItem("sortDropdown",o);const n=document.getElementById("value-sort-dropdown").value;sessionStorage.setItem("valueSortDropdown",n),sortItems()},"function"!=typeof window.sortItems&&(console.warn("sortItems not found on window object, ensuring it's defined"),window.sortItems=function(){console.warn("Fallback sortItems called - page may need refresh")});