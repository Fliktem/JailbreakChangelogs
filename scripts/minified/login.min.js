function checkAndStoreReportIssue(){const e=new URLSearchParams(window.location.search),o=new URLSearchParams(document.referrer.split("?")[1]||"");(e.has("report-issue")||o.has("report-issue"))&&localStorage.setItem("reportIssueRedirect","true")}$(document).ready((function(){checkAndStoreReportIssue();const e=new URLSearchParams(window.location.search).get("redirect");e&&localStorage.setItem("loginRedirect",e);const o=$("#ageCheck"),t=$("#tosCheck"),n=$("#login-button");function r(){n.prop("disabled",!(o.prop("checked")&&t.prop("checked")))}o.change(r),t.change(r);const c=window.location.hostname;let i;i="jailbreakchangelogs.xyz"===c?"https://discord.com/oauth2/authorize?client_id=1281308669299920907&response_type=code&redirect_uri=https%3A%2F%2Fjailbreakchangelogs.xyz%2Flogin&scope=identify&prompt=none":"https://discord.com/oauth2/authorize?client_id=1281308669299920907&response_type=code&redirect_uri=https%3A%2F%2Ftesting.jailbreakchangelogs.xyz%2Flogin&scope=identify";const a=document.getElementById("login-button"),s=window.location.pathname+window.location.search;if("/login"===s||s.includes("/login")||window.location.href.includes("discord.com")||(window.location.search.includes("report-issue")&&localStorage.setItem("reportIssueRedirect","true"),localStorage.setItem("loginRedirect",s)),a.addEventListener("click",(()=>{console.log("Redirecting to Discord OAuth..."),window.location.href=i})),window.location.search.includes("code=")){const e=new URLSearchParams(window.location.search).get("code");fetch("https://api3.jailbreakchangelogs.xyz/auth?code="+e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>{if(403===e.status)throw new Error("banned");if(!e.ok)throw new Error("network");return e.json()})).then((e=>{if(e&&e.id&&e.avatar){const o=`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`;if(Cookies.set("token",e.token,{expires:7}),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("avatar",o),localStorage.setItem("userid",e.id),localStorage.getItem("reportIssueRedirect"))return localStorage.removeItem("reportIssueRedirect"),void(window.location.href="/?report-issue&freshlogin=true");const t=localStorage.getItem("loginRedirect");return t?(window.location.href=`${t}${t.includes("?")?"&":"?"}freshlogin=true`,void localStorage.removeItem("loginRedirect")):void(window.location.href="/?freshlogin=true")}})).catch((e=>{"banned"===e.message?(notyf.error("Your account has been banned from Jailbreak Changelogs."),setTimeout((()=>{window.location.href="/"}),3500)):(console.error("Login error:",e),window.location.href="/")}))}})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("ageCheck"),o=document.getElementById("tosCheck"),t=document.getElementById("login-button"),n=new bootstrap.Tooltip(t,{title:"Please agree to the terms and confirm your age",trigger:"hover",placement:"top"});function r(){const r=e.checked&&o.checked;t.disabled=!r,r?n.disable():n.enable()}e.addEventListener("change",r),o.addEventListener("change",r)}));